--[[
请勿破解本文件，防君子不防小人！
与世隔绝  与世无争  登峰造极  自在逍遥
]]
local TD_R=td1madao_sv()local TD_V={}TD_V[75]=TD_R({259,263,226,240,237})TD_V[78]=TD_R({187,251,198,228,271,238})TD_V[14]=TD_R({247,273,264,242,225,264,246,249,261,264,234,245,248,278,263,241,268,264,261,264,290})TD_V[2]=TD_R({223,251,242,252,129,254,280,271,249,232,272,253,256,268,271,241,252,256,285,270,150,303,271,286})TD_V[4]=TD_R({161,201,196,190,165,168,190,177})TD_V[27]=TD_R({127,123,132})TD_V[39]=TD_R({169,207})TD_V[29]=TD_R({247,273,264,242,225,264,246,249,261,264,234,245,248,278,263,143,242,270,265,262,266,291,283,282})TD_V[7]=TD_R({487,361,410,492,325,292,516,415,321,506,426,351,504,304,341,507,422,372,515,360,408,515,429,318,528,413,388,320})TD_V[82]=TD_R({253,233,260,264,245,266,270,269})TD_V[5]=TD_R({493,413,338,496,353,394,496,367,401,498,424,355,506,370,329,507,426,310,511,426,330,519,375,392,522,393,426,546,445,389})TD_V[51]=TD_R({131,127})TD_V[34]=TD_R({247,273,264,242,225,256,248,233,261,232,274,269,240,286,269})TD_V[25]=TD_R({247,273,264,242,203,230,244,229,269,250,254,265,268})TD_V[74]=TD_R({259,263,226,232,249,230,234,255,243})TD_V[21]=TD_R({135,127})TD_V[46]=TD_R({125,123,144})TD_V[11]=TD_R({247,273,264,242,225,264,246,249,261,264,234,245,248,278,263})TD_V[17]=TD_R({127,143,128})TD_V[44]=TD_R({125,123,140})TD_V[57]=TD_R({233,265,234,250,267,278,262,241})TD_V[24]=TD_R({247,273,264,242,225,264,246,249,261,264,234,243,268,266,251})TD_V[62]=TD_R({185,169,212,164})TD_V[22]=TD_R({133,143,128})TD_V[43]=TD_R({245,233,268,236,251,134})TD_V[59]=TD_R({183,189,188,184,173,214,228,189,187,198,186})TD_V[60]=TD_R({165,169,198,168,199,182,170,177})TD_V[45]=TD_R({259,239,226,234,237,264,268,133,235,262,254,263,138,262,279,259})TD_V[31]=TD_R({239,251,262,258,237,234,270,233,237,258,246})TD_V[23]=TD_R({257,239,242,254,257,226,234,261,271,272,234,275,270,242,287,271})TD_V[33]=TD_R({247,273,264,242,225,264,246,249,261,264,234,277,248,242,267})TD_V[48]=TD_R({129,127,128})TD_V[53]=TD_R({253,259,234,238,229,232})TD_V[66]=TD_R({231,251,264,244,267,278})TD_V[55]=TD_R({227,253,250,258,257,256,240,259,273,272})TD_V[65]=TD_R({159,251,242,252,201,268,232,271,243})TD_V[10]=TD_R({233,241,260,236})TD_V[18]=TD_R({259,269,226,258,133})TD_V[41]=TD_R({125,123,134})TD_V[38]=TD_R({239,261,252,244,241,244,270})TD_V[19]=TD_R({137,127,128})TD_V[47]=TD_R({125,123,138})TD_V[13]=TD_R({231,249,256,266,277})TD_V[16]=TD_R({245,241,238,242,267})TD_V[32]=TD_R({261,241,250,236,263})TD_V[70]=TD_R({239,261,262,258,263,246,258,245})TD_V[72]=TD_R({237,233,226,250,267,244})TD_V[81]=TD_R({171,233,264,180,267,238,256})TD_V[1]=TD_R({159,187,178,188})TD_V[52]=TD_R({223,251,242,252,129,234,232,257,265,246,254,273,248,238,253,261,280,256,147,300,268,283})TD_V[68]=TD_R({245,241,238,242,267,240,278})TD_V[15]=TD_R({125})TD_V[67]=TD_R({171,201,178,170})TD_V[8]=TD_R({127})TD_V[12]=TD_R({233,241,260,236,139})TD_V[40]=TD_R({185,189,166,186,181,170,188})TD_V[58]=TD_R({163,175,162,198,165,170,206,177,205,208})TD_V[35]=TD_R({251,251,260,236,253,258,274,241})TD_V[3]=TD_R({253,233,226,232,243})TD_V[71]=TD_R({257,239,242,254,257,266})TD_V[26]=TD_R({247,273,264,242,225,264,246,249,261,264,234,245,248,278,263,143,284,256,295})TD_V[73]=TD_R({197,259,226,254,265,240,260,267,259})TD_V[20]=TD_R({227,231})TD_V[77]=TD_R({239,261,250,228,265,268,240,267,271,252,262})TD_V[49]=TD_R({129,137,138})TD_V[50]=TD_R({127,131,140})TD_V[63]=TD_R({203,175,178,202,173,226,170,197,197,180})TD_V[69]=TD_R({259,263,226,266,237})TD_V[61]=TD_R({183,209,200,178,225,200,182,185,197,200,234,181,184,214,199})TD_V[6]=TD_R({493,413,338,494,357,316,496,385,329,502,348,395,502,428,359,509,382,328,513,350,398,515,439,344,520,439,372,534,367,453,534,382,339,554,454,397})TD_V[30]=TD_R({245,241,238,242,267,258,258,229,241,252,272,277,288})TD_V[42]=TD_R({227,225,250,258,239,246,266,241,231,246,254,273,248})TD_V[64]=TD_R({219,247,242,240,243,268,260,259})TD_V[36]=TD_R({261,241,250,236,263,236,260,259,243})TD_V[56]=TD_R({233,265,234,250})TD_V[80]=TD_R({187,251,196,242,245,256,260,175,251,244})TD_V[76]=TD_R({249,225,250,236})TD_V[9]=TD_R({133})TD_V[28]=TD_R({239,231,248,236})TD_V[37]=TD_R({239,261,232,228,277})TD_V[79]=TD_R({187,251,184,256,229,236})TD_V[54]=TD_R({245,241,238,242,267,226,260,259})TD_R=TD_V local assets={Asset(TD_V[1],TD_V[2]),}local function _isvalid(desk,inst)if not(inst and inst:IsValid())then return end if not desk[TD_V[3]]and inst[TD_V[53]]==TD_V[3]then return true end if not desk[TD_V[54]]and inst[TD_V[55]][TD_V[56]]and inst[TD_V[55]][TD_V[56]][TD_V[57]]==TD_V[4]then return true end end Myth_AddCachedStr(function()STRINGS[TD_V[58]][TD_V[59]][TD_V[60]][TD_V[61]]=TD_V[5]STRINGS[TD_V[58]][TD_V[62]][TD_V[60]][TD_V[61]]=TD_V[6]STRINGS[TD_V[58]][TD_V[63]][TD_V[61]]=TD_V[7]end)local function OnLightDirty(inst)local on=inst[TD_V[64]]:value()for i=TN(TD_V[8]),TN(TD_V[9])do inst[TD_V[65]]:OverrideSymbol(TD_V[10]..i,TD_V[11],on and TD_V[12]or TD_V[13])if on then local light=SpawnPrefab(TD_V[14])local f=light[TD_V[66]]:AddFollower()f:FollowSymbol(inst[TD_V[67]],TD_V[10]..i,TN(TD_V[15]),TN(TD_V[15]),TN(TD_V[15]))inst[TD_V[68]][i]=light else if inst[TD_V[68]][i]and inst[TD_V[68]][i]:IsValid()then inst[TD_V[68]][i]:Remove()inst[TD_V[68]][i]=nil end end end end local function LightOn(inst)if inst[TD_V[54]]then return end inst[TD_V[54]]=true inst[TD_V[64]]:set_local(false)inst[TD_V[64]]:set(true)if not inst[TD_V[55]][TD_V[32]]:TimerExists(TD_V[16])then inst[TD_V[55]][TD_V[32]]:StartTimer(TD_V[16],TN(TD_V[17]))end end local function LightOff(inst)if not inst[TD_V[54]]then return end inst[TD_V[54]]=false inst[TD_V[64]]:set_local(true)inst[TD_V[64]]:set(false)end local function AddPeach(inst)if not inst[TD_V[3]]then inst[TD_V[3]]=true inst[TD_V[65]]:ShowSymbol(TD_V[18])if not inst[TD_V[55]][TD_V[32]]:TimerExists(TD_V[3])then inst[TD_V[55]][TD_V[32]]:StartTimer(TD_V[3],TN(TD_V[19]))end end end local function RemovePeach(inst)inst[TD_V[3]]=false inst[TD_V[65]]:HideSymbol(TD_V[18])end local function RhinoFn(inst)if not inst[TD_V[3]]or not inst[TD_V[54]]then return end if not(TheWorld[TD_V[69]][TD_V[70]]and TheWorld[TD_V[69]][TD_V[38]])then return end local has=false for k in pairs(inst[TD_V[71]])do if not k:IsValid()or k[TD_V[55]][TD_V[72]]:IsDead()then inst[TD_V[71]][k]=nil else has=true end end if has then return end if inst[TD_V[55]][TD_V[32]]:TimerExists(TD_V[20])then return else inst[TD_V[55]][TD_V[32]]:StartTimer(TD_V[20],TN(TD_V[21])*TN(TD_V[22]))TheWorld:PushEvent(TD_V[23])local rhino=SpawnPrefab(TD_V[24])rhino[TD_V[73]]:SetPosition(inst[TD_V[73]]:GetWorldPosition())rhino:SetTarget(inst)end end local function GetItem(inst,item)if _isvalid(inst,item)then if item[TD_V[55]][TD_V[74]]then item=item[TD_V[55]][TD_V[74]]:Get()end if item[TD_V[53]]==TD_V[3]then AddPeach(inst)elseif item[TD_V[55]][TD_V[56]]then LightOn(inst)end item:Remove()if inst[TD_V[54]]and inst[TD_V[3]]then RhinoFn(inst)end return true end return false end local function OnRhinoDie(inst)for k in pairs(inst[TD_V[71]])do if not k:IsValid()then inst[TD_V[71]][k]=nil else if k:HasTag(TD_V[25])and not k[TD_V[55]][TD_V[72]]:IsDead()then k:SetStage(k[TD_V[75]]+TN(TD_V[8]))end end end end local function OnSave(inst,data)data[TD_V[54]]=inst[TD_V[54]]data[TD_V[3]]=inst[TD_V[3]]end local function OnLoad(inst,data)if not data then return end if data[TD_V[3]]then AddPeach(inst)end if data[TD_V[54]]then LightOn(inst)end end local function OnDay(inst)LightOff(inst)RemovePeach(inst)end local function OnTimerDone(inst,data)if data and data[TD_V[76]]==TD_V[3]then RemovePeach(inst)end if data and data[TD_V[76]]==TD_V[16]then LightOff(inst)end end local function fn()local inst=CreateEntity()local trans=inst[TD_V[66]]:AddTransform()local anim=inst[TD_V[66]]:AddAnimState()local minimap=inst[TD_V[66]]:AddMiniMapEntity()minimap:SetIcon(TD_V[26])inst[TD_V[66]]:AddNetwork()MakeObstaclePhysics(inst,TN(TD_V[27]))trans:SetScale(TN(TD_V[27]),TN(TD_V[27]),TN(TD_V[27]))anim:SetBank(TD_V[11])anim:SetBuild(TD_V[11])anim:PlayAnimation(TD_V[28])for i=TN(TD_V[8]),TN(TD_V[9])do anim:OverrideSymbol(TD_V[10]..i,TD_V[11],TD_V[13])end inst[TD_V[68]]={}inst[TD_V[71]]={}inst[TD_V[3]]=false inst[TD_V[54]]=false inst[TD_V[64]]=net_bool(inst[TD_V[67]],TD_V[29],TD_V[30])inst[TD_V[64]]:set_local(true)inst:ListenForEvent(TD_V[30],OnLightDirty)inst[TD_V[66]]:SetPristine()if not TheWorld[TD_V[77]]then return inst end inst:AddComponent(TD_V[31])inst:AddComponent(TD_V[32])inst:AddComponent(TD_V[33])inst:AddComponent(TD_V[34])inst[TD_V[78]]=OnSave inst[TD_V[79]]=OnLoad inst[TD_V[80]]=OnRhinoDie LightOff(inst)RemovePeach(inst)inst:ListenForEvent(TD_V[35],LightOff)inst:ListenForEvent(TD_V[36],OnTimerDone)inst:WatchWorldState(TD_V[37],OnDay)inst:WatchWorldState(TD_V[38],RhinoFn)inst[TD_V[81]]=GetItem return inst end local function light()local inst=CreateEntity()inst[TD_V[82]]=false inst:AddTag(TD_V[39])inst:AddTag(TD_V[40])local trans=inst[TD_V[66]]:AddTransform()trans:SetScale(TN(TD_V[41]),TN(TD_V[41]),TN(TD_V[41]))local anim=inst[TD_V[66]]:AddAnimState()anim:SetBank(TD_V[42])anim:SetBuild(TD_V[42])anim:PlayAnimation(TD_V[43],true)anim:SetMultColour(TN(TD_V[8]),TN(TD_V[44]),TN(TD_V[8]),TN(TD_V[8]))anim:SetLightOverride(TN(TD_V[8]))anim:SetBloomEffectHandle(TD_V[45])anim:SetRayTestOnBB(true)anim:SetFinalOffset(-TN(TD_V[8]))local light=inst[TD_V[66]]:AddLight()light:SetRadius(TN(TD_V[8]))light:Enable(true)light:SetIntensity(TN(TD_V[46]))light:SetFalloff(TN(TD_V[47]))light:SetColour(TN(TD_V[48])/TN(TD_V[49]),TN(TD_V[50])/TN(TD_V[49]),TN(TD_V[51])/TN(TD_V[49]))return inst end return Prefab(TD_V[11],fn,assets),Prefab(TD_V[14],light,{Asset(TD_V[1],TD_V[52])})
